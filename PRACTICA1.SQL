DROP TABLE BLOQUEPISOS CASCADE CONSTRAINTS;
DROP TABLE ZONAS CASCADE CONSTRAINTS;

CREATE TABLE ZONAS (
COD_ZONA NUMBER(3,0) PRIMARY KEY,
NOMBREZONA VARCHAR2(15) NOT NULL,
MASDATOS VARCHAR2(60),

CONSTRAINT ZNS_NMZ_UK UNIQUE (NOMBREZONA),
CONSTRAINT ZNS_NMZ_CK CHECK(NOMBREZONA = UPPER(NOMBREZONA))
);




CREATE TABLE BLOQUEPISOS (
    CALLE VARCHAR2(30),
    NUMERO NUMBER(3,0),
    PISO NUMBER(2,0),
    PUERTA CHAR(1),
    CODIGO_POSTAL VARCHAR2(5) DEFAULT '00000',
    METROS NUMBER(5,0) NOT NULL,
    COMENTARIOS VARCHAR2(60),
    COD_ZONA NUMBER(3,0),
    DNI VARCHAR2(10),

    CONSTRAINT BP_PK PRIMARY KEY(CALLE,NUMERO,PISO,PUERTA),
    CONSTRAINT BP_MTS_CK CHECK(METROS > 0 AND METROS < 300), --CHECK (METROS BETWEEN 1 AND 300)
    CONSTRAINT BP_COZ_FK FOREIGN KEY(COD_ZONA) REFERENCES ZONAS (COD_ZONA)
    ON DELETE SET NULL
);




COMMIT;

/*PASO 3*/

/* INSERTS PARA ZONAS 

INSERT INTO ZONAS (COD_ZONA, NOMBREZONA, MASDATOS) VALUES(1,'LAKUA','ZONA UBICADA EN LA ZONA NORTE DE VITORIA-GASTEIZ');
INSERT INTO ZONAS (COD_ZONA, NOMBREZONA, MASDATOS) VALUES(2,'CENTRO','ZONA UBICADA EN LA ZONA CENTRO DE VITORIA-GASTEIZ');
INSERT INTO ZONAS (COD_ZONA, NOMBREZONA, MASDATOS) VALUES(3,'CORONACION','ZONA UBICADA EN LA ZONA NORTE DE VITORIA-GASTEIZ');

*/


/* INSERTS PARA BLOQUEPISOS 

INSERT INTO BLOQUEPISOS VALUES('JUNTAS GENERALES',20,1,'A',1010,120,NULL,1,'16292435F');
INSERT INTO BLOQUEPISOS VALUES('EDUARDO DATO',15,5,'I',1005,100,NULL,2,'16297775A');
INSERT INTO BLOQUEPISOS VALUES('CUCHILLERIA',14,2,'D',1010,120,NULL,2,'12342435I');
INSERT INTO BLOQUEPISOS VALUES('DOMINGO BELTRAN',23,1,'D',1012,90,NULL,3,'11245635F');

*/

/* PASO 4 

CREATE TABLE PISOS_LAKUA AS
SELECT CALLE, NUMERO, PISO, PUERTA, CODIGO_POSTAL, METROS, DNI
FROM BLOQUEPISOS
WHERE COD_ZONA = '1'; 

*/
